window._ccScriptSettings = {"scriptKey":"b58d9dd1-1260-441b-ba8a-2fcbde421e4b","browserCacheUserTracking":true,"localCacheUserTracking":true,"cookieSettingsType":0,"launcherScripts":["https://script-api.ccgateway.net/1/userId","https://script-api.ccgateway.net/script/launcher/2/user.js","https://script-api.ccgateway.net/script/launcher/1/customevents.js","https://script-api.ccgateway.net/script/launcher/6/api.js"],"customScripts":[],"site":{"scriptId":"www.discogs.com","parentId":"5bb3e20859","sharedDomain":true,"whitelist":false},"analytics":{"heartbeat":false,"fingerprint":false,"clickout":true,"adiq":false,"contextual":true,"customTaxonomy":false,"dealIdMapping":false,"dualTargeting":false},"syncs":{"active":true,"partnerSyncs":{"bidswitch":{"partnerTypeId":0,"id":"bidSwitch","partnerId":"153","active":false},"blueKai":{"partnerTypeId":0,"id":"blueKai","partnerId":"82487","active":true},"cmi":{"partnerTypeId":0,"id":"cmi","partnerId":"1234","active":false},"exelate":{"partnerTypeId":0,"id":"exelate","partnerId":"864","active":false,"siteId":"974"},"eyeota":{"partnerTypeId":0,"id":"eyeota","partnerId":"cb2cb90","active":true,"siteId":"974"},"lotame":{"partnerTypeId":0,"id":"lotame","partnerId":"10114","active":false},"magnite":{"partnerTypeId":0,"id":"magnite","partnerId":"52318","active":false},"nielsen":{"partnerTypeId":0,"id":"nielsen","partnerId":"1060","active":false,"siteId":"974"},"semasio":{"partnerTypeId":0,"id":"semasio","partnerId":"carbon/1","active":false},"shareThis":{"partnerTypeId":0,"id":"shareThis","partnerId":"1234","active":false},"xandr":{"partnerTypeId":0,"id":"xandr","partnerId":"","active":false},"zeotap":{"partnerTypeId":0,"id":"zeotap","partnerId":"1380","active":false}}},"user":{"id":"","ip":"97.113.245.57","fingerprint":"97.113.245.57:2","audienceMemberships":null,"isNew":false,"requiresFingerprint":false,"ios":false,"cached":false,"optOut":false},"session":{"id":"","isNew":false},"conversions":{"baseScript":false,"alwaysFire":false,"urlTriggers":[]},"customEvents":{"triggers":{"click":null,"keyPress":null,"clickout":null}},"realtime":{"loadIntent":false,"loadAudiences":false,"loadBrands":false,"loadDemographics":false,"setGptTargeting":false,"setPrebidConfig":false},"sampling":{"active":false,"size":0.05},"tap":{"active":false,"accountId":"43ce7925-afb8-48af-896b-d9aabce331a7"}};
window._ccLauncherSettings = {"activeParent":true,"timestamp":"2026-01-11 23:28:25","api":"https://script-api.ccgateway.net","cdn":"https://script-api.ccgateway.net","ingestion":"https://pb-ing-02.ccgateway.net/v1.0","location":"https://privacy-location-edge.ccgateway.net","customEvents":"https://ce21.ccgateway.net","gppDecoder":"https://gpp-decoder.magnite-audience-prod.com","script":"www.discogs.com","parent":"5bb3e20859"};
;(function(win,doc){win["ccao"]=win["ccao"]||{};win["cca"]=win["cca"]||{};var ccao=win["cca"];const carbonVendorID=493;ccao.privacy={que:ccao.privacy?.que||[],law:"unknown",ready:false,log:[],gdpr:{CS:"",Consent:false},ccpa:{ConsentString:"",Consent:false}};if(win["ccao"].privacy&&win["ccao"].privacy.que){ccao.privacy.que=ccao.privacy.que.concat(win["ccao"].privacy.que);}
var logMessage=function(level,message){ccao.privacy.log.push(`[${level}]: ${message}`);}
var activatePrivacy=function(){if(ccao.privacy&&ccao.privacy.ready){logMessage("[WARNING] Attempted to ready privacy again");return}
ccao.privacy.ready=true;var tempQue=ccao.privacy.que
for(privacyCallback of tempQue){try{privacyCallback();}catch(e){logMessage("[ERROR] issue in callback: "+e.name+": "+e.message)}}
ccao.privacy.que={push:function(privacyCallback){try{privacyCallback();}catch(e){logMessage("[ERROR] issue in callback: "+e.name+": "+e.message)}}}
var tempQue=null;logMessage("[INFO] Closing privacy que, record below, ideally it should be empty: "+JSON.stringify(ccao.privacy.que));logMessage("[INFO] logging final object: "+JSON.stringify(ccao.privacy));}
var checkGdprTCFV1=function(gdprApi){logMessage("[INFO]","Checking Consent TCF V1");let consentDataCallback=function(result,success){logMessage("[INFO]","Entering Second TCF Callback");if(!success){logMessage("[ERROR]","Failed to get TCF consent data");activatePrivacy();return;}
logMessage("[INFO]","GDPR obtaining consent string");ccao.privacy.gdpr.CS=result.consentData||"";activatePrivacy();};let vendorConsentCallback=function(result,success){logMessage("[INFO]","Entering First TCF Callback");if(!success){logMessage("[ERROR]","First TCF Callback Failed");activatePrivacy();return;}
logMessage("[INFO]","First TCF Callback Succeeded");if(!result||!result.gdprApplies){logMessage("[INFO]","GDPR does not apply");activatePrivacy();return;}
if(!result.vendorConsents||!result.vendorConsents[carbonVendorID]){logMessage("[INFO]","GDPR consent not granted");ccao.privacy.gdpr.Consent=false;activatePrivacy();return;}
logMessage("[INFO]","GDPR consent granted");ccao.privacy.gdpr.Consent=true;gdprApi('getConsentData',null,consentDataCallback);};gdprApi('getVendorConsents',[carbonVendorID],vendorConsentCallback);}
var checkGdprTCFV2=function(gdprApi){logMessage("[INFO]","Checking Consent TCF V2");var tcfCallback=function(data,success){logMessage("[INFO]","Entering TCF Callback");if(!success||(data.eventStatus!=='tcloaded'&&data.eventStatus!=='useractioncomplete')){logMessage("[ERROR]","TCF Callback Failed");activatePrivacy();return;}
logMessage("[INFO]","TCF Callback Succeeded");if(!data.gdprApplies){logMessage("[INFO]","GDPR does not apply");activatePrivacy();return;}
logMessage("[INFO]","GDPR obtaining consent string");ccao.privacy.gdpr.CS=data.tcString;if(!data.vendor?.consents){logMessage("[ERROR]","GDPR Unable to Obtain Consent");activatePrivacy();return;}
logMessage("[INFO]","GDPR obtaining carbon consent status");ccao.privacy.gdpr.Consent=data.vendor.consents[carbonVendorID]||false;activatePrivacy();gdprApi("removeEventListener",2,function(success){if(!success){logMessage("[ERROR]","GDPR Failed to remove event listener");}},data.listenerId);}
gdprApi("addEventListener",2,tcfCallback);}
var checkConsentGdpr=function(){if(window.__tcfapi){logMessage("[INFO]","TCF Api V2 found");checkGdprTCFV2(window.__tcfapi);return;}else if(window.__cmp){logMessage("[INFO]","TCF Api V1.1 found");checkGdprTCFV1(window.__cmp);return;}
logMessage("[ERROR]","TCF Api not found");}
var checkUSP=function(uspApi){logMessage("[INFO]","Checking Consent USP");let uspCallback=function(data,success){logMessage("[INFO]","Entering USP Callback");if(!success){logMessage("[ERROR]","USP Callback Failed");return;}
logMessage("[INFO]","USP obtaining consent string");ccao.privacy.ccpa.ConsentString=data.uspString;logMessage("[INFO]","USP obtaining carbon consent status");if(data.uspString[2]=="-"||(data.uspString[2].toLowerCase()=="n"&&data.uspString[1].toLowerCase()=='y')){logMessage("[INFO]","USP consent given");ccao.privacy.ccpa.Consent=true;}else if(data.uspString[2].toLowerCase()=="y"){logMessage("[INFO]","USP consent not given");ccao.privacy.ccpa.Consent=false;}else{logMessage("[WARN]","USP consent could not be determined");ccao.privacy.ccpa.Consent=false;}
activatePrivacy();};uspApi("getUSPData",1,uspCallback);}
var checkConsentUsp=function(){if(window.__uspapi){logMessage("[INFO]","USP Api found");checkUSP(window.__uspapi);return;}
logMessage("[ERROR]","USP Api not found");return;}
var geoFound=function(region){if(ccao.privacy.ready){logMessage("[WARNING]","attempted to activate privacy again");return;}
switch(region.toLowerCase()){case "eu":case "uk":ccao.privacy.law="gdpr";checkConsentGdpr();break;case "us":case "ca":ccao.privacy.law="ccpa";checkConsentUsp();break;case "other":ccao.privacy.law="na";activatePrivacy();break;case "optout":ccao.privacy.law="optout";if(window.localStorage)window.localStorage.clear();if(window.sessionStorage)window.sessionStorage.clear();if(win._ccLauncherSettings&&win._ccLauncherSettings.api){var deleteCookiePixel=new Image(1,1);deleteCookiePixel.src=win._ccLauncherSettings.api+"/forget";}
activatePrivacy();break;default:ccao.privacy.law="unknown";activatePrivacy();break;}}
var fetchUserGeo=function(){try{let req=new XMLHttpRequest();req.onreadystatechange=function(){if(req.readyState==4&&req.status==200){logMessage("INFO",`User geo request complete. status: ${req.status}`);try{geoFound(req.responseText);}catch(err){logMessage("ERROR",`Error while executing geo callback: ${err.toString()}`);}}};logMessage("INFO","Requesting user geo");req.open("GET",`${win._ccLauncherSettings.location}/privacy/location`,true);req.send();}catch(err){logMessage("ERROR",`Error while requesting user geo: ${err.toString()}`);}}
var decodeGppTcf=function(gppString){try{let req=new XMLHttpRequest();req.onreadystatechange=function(){if(req.readyState==4&&req.status==200){logMessage("INFO",`gpp string decode complete. status: ${req.status}`);try{var tcfData=JSON.parse(req.responseText)
if(carbonVendorID.toString()in tcfData.VendorsConsent){ccao.privacy.gdpr.Consent=tcfData.VendorsConsent[carbonVendorID.toString()];}
activatePrivacy();}catch(err){logMessage("ERROR",`Error while executing gpp decode callback: ${err.toString()}`);}}};logMessage("INFO","requesting gpp string decode");req.open("GET",`${win._ccLauncherSettings.gppDecoder}/gpp-decoder/v1/decode/tcf?gppString=${gppString}`,true);req.send();}catch(err){logMessage("ERROR",`Error while requesting gpp string decode: ${err.toString()}`);}}
var decodeGppUsnat=function(gppString){try{let req=new XMLHttpRequest();req.onreadystatechange=function(){if(req.readyState==4&&req.status==200){logMessage("INFO",`gpp string decode complete. status: ${req.status}`);try{var usnatData=JSON.parse(req.responseText)
ccao.privacy.ccpa.Consent=(usnatData.SharingNotice==1&&usnatData.SharingOptOutNotice==1);activatePrivacy();}catch(err){logMessage("ERROR",`Error while executing gpp decode callback: ${err.toString()}`);}}};logMessage("INFO","requesting gpp string decode");req.open("GET",`${win._ccLauncherSettings.gppDecoder}/gpp-decoder/v1/decode/usnat?gppString=${gppString}`,true);req.send();}catch(err){logMessage("ERROR",`Error while requesting gpp string decode: ${err.toString()}`);}}
var processGppData=function(gppData){var gppString=gppData.gppString;if(gppData.applicableSections.length==0||gppData.applicableSections.includes(-1)){ccao.privacy.law='na';activatePrivacy();return;}
if('tcfeuv2'in gppData.parsedSections&&gppData.applicableSections.includes(2)){logMessage("INFO","checking tcfeuv2 section");__gpp('getField',function(tcfVersion){if(tcfVersion==2){__gpp('getField',function(vendorConsents){ccao.privacy.law='gdpr';ccao.privacy.gdpr.CS=gppString;ccao.privacy.gdpr.Consent=vendorConsents.includes(carbonVendorID);activatePrivacy();},'tcfeuv2.VendorConsents');}else{ccao.privacy.law='gdpr';ccao.privacy.gdpr.CS=gppString;ccao.privacy.gdpr.Consent=false
decodeGppTcf(gppString);}},'tcfeuv2.Version');return;}
if('tcfcav1'in gppData.parsedSections&&gppData.applicableSections.includes(5)){logMessage("INFO","checking tcfcav1 section");var sectionData=Array.isArray(gppData.parsedSections.tcfeuv2)?gppData.parsedSections.tcfeuv2[0]:gppData.parsedSections.tcfcav1;ccao.privacy.law='ccpa';ccao.privacy.ccpa.CS=gppString;ccao.privacy.ccpa.Consent=sectionData.VendorExpressConsent.includes(493);}
if('usnat'in gppData.parsedSections&&gppData.applicableSections.includes(7)){logMessage("INFO","checking usnat section");var sectionData=Array.isArray(gppData.parsedSections.usnat)?gppData.parsedSections.usnat[0]:gppData.parsedSections.usnat;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=(sectionData.SharingNotice==1&&sectionData.SharingOptOutNotice==1&&!sectionData.Gpc);if(!ccao.privacy.ccpa.Consent&&!sectionData.Gpc){decodeGppUsnat(gppString);return;}}
if('usnatv1'in gppData.parsedSections&&gppData.applicableSections.includes(7)){logMessage("INFO","checking usnatv1 section");var sectionData=Array.isArray(gppData.parsedSections.usnatv1)?gppData.parsedSections.usnatv1[0]:gppData.parsedSections.usnatv1;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=(sectionData.SharingNotice==1&&sectionData.SharingOptOutNotice==1&&!sectionData.Gpc);if(!ccao.privacy.ccpa.Consent&&!sectionData.Gpc){decodeGppUsnat(gppString);return;}}
if('usca'in gppData.parsedSections&&gppData.applicableSections.includes(8)){logMessage("INFO","checking usca section");var sectionData=Array.isArray(gppData.parsedSections.usca)?gppData.parsedSections.usca[0]:gppData.parsedSections.usca;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=(sectionData.SharingNotice==1&&sectionData.SharingOptOutNotice==1&&!sectionData.Gpc);}
if('usva'in gppData.parsedSections&&gppData.applicableSections.includes(9)){logMessage("INFO","checking usva section");var sectionData=Array.isArray(gppData.parsedSections.usva)?gppData.parsedSections.usva[0]:gppData.parsedSections.usva;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.SharingNotice==1&&!sectionData.Gpc;}
if('usco'in gppData.parsedSections&&gppData.applicableSections.includes(10)){logMessage("INFO","checking usco section");var sectionData=Array.isArray(gppData.parsedSections.usco)?gppData.parsedSections.usco[0]:gppData.parsedSections.usco;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.SharingNotice==1&&!sectionData.Gpc;}
if('usut'in gppData.parsedSections&&gppData.applicableSections.includes(11)){logMessage("INFO","checking usut section");var sectionData=Array.isArray(gppData.parsedSections.usut)?gppData.parsedSections.usut[0]:gppData.parsedSections.usut;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.SharingNotice==1&&!sectionData.Gpc;}
if('usct'in gppData.parsedSections&&gppData.applicableSections.includes(12)){logMessage("INFO","checking usct section");var sectionData=Array.isArray(gppData.parsedSections.usct)?gppData.parsedSections.usct[0]:gppData.parsedSections.usct;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.SharingNotice==1&&!sectionData.Gpc;}
if('usfl'in gppData.parsedSections&&gppData.applicableSections.includes(13)){logMessage("INFO","checking usfl section");var sectionData=Array.isArray(gppData.parsedSections.usfl)?gppData.parsedSections.usfl[0]:gppData.parsedSections.usfl;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usmt'in gppData.parsedSections&&gppData.applicableSections.includes(14)){logMessage("INFO","checking usmt section");var sectionData=Array.isArray(gppData.parsedSections.usmt)?gppData.parsedSections.usmt[0]:gppData.parsedSections.usmt;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.SharingNotice==1&&!sectionData.Gpc;}
if('usor'in gppData.parsedSections&&gppData.applicableSections.includes(15)){logMessage("INFO","checking usor section");var sectionData=Array.isArray(gppData.parsedSections.usor)?gppData.parsedSections.usor[0]:gppData.parsedSections.usor;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('ustx'in gppData.parsedSections&&gppData.applicableSections.includes(16)){logMessage("INFO","checking ustx section");var sectionData=Array.isArray(gppData.parsedSections.ustx)?gppData.parsedSections.ustx[0]:gppData.parsedSections.ustx;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usde'in gppData.parsedSections&&gppData.applicableSections.includes(17)){logMessage("INFO","checking usde section");var sectionData=Array.isArray(gppData.parsedSections.usde)?gppData.parsedSections.usde[0]:gppData.parsedSections.usde;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usia'in gppData.parsedSections&&gppData.applicableSections.includes(18)){logMessage("INFO","checking usia section");var sectionData=Array.isArray(gppData.parsedSections.usia)?gppData.parsedSections.usia[0]:gppData.parsedSections.usia;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usne'in gppData.parsedSections&&gppData.applicableSections.includes(19)){logMessage("INFO","checking usne section");var sectionData=Array.isArray(gppData.parsedSections.usne)?gppData.parsedSections.usne[0]:gppData.parsedSections.usne;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usnh'in gppData.parsedSections&&gppData.applicableSections.includes(20)){logMessage("INFO","checking usnh section");var sectionData=Array.isArray(gppData.parsedSections.usnh)?gppData.parsedSections.usnh[0]:gppData.parsedSections.usnh;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('usnj'in gppData.parsedSections&&gppData.applicableSections.includes(21)){logMessage("INFO","checking usnj section");var sectionData=Array.isArray(gppData.parsedSections.usnj)?gppData.parsedSections.usnj[0]:gppData.parsedSections.usnj;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('ustn'in gppData.parsedSections&&gppData.applicableSections.includes(22)){logMessage("INFO","checking ustn section");var sectionData=Array.isArray(gppData.parsedSections.ustn)?gppData.parsedSections.ustn[0]:gppData.parsedSections.ustn;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=gppString;ccao.privacy.ccpa.Consent=sectionData.ProcessingNotice==1&&!sectionData.Gpc;}
if('uspv1'in gppData.parsedSections&&gppData.applicableSections.includes(6)){logMessage("INFO","checking uspv1 section");var sectionData=Array.isArray(gppData.parsedSections.uspv1)?gppData.parsedSections.uspv1[0]:gppData.parsedSections.uspv1;ccao.privacy.law='ccpa';ccao.privacy.ccpa.ConsentString=sectionData;if(sectionData[2]=="-"||(sectionData[2].toLowerCase()=="n"&&sectionData[1].toLowerCase()=='y')){ccao.privacy.ccpa.Consent=true;}else if(sectionData[2].toLowerCase()=="y"){ccao.privacy.ccpa.Consent=false;}else{ccao.privacy.ccpa.Consent=false;}}
activatePrivacy();}
var awaitGpp=function(gppApi,signalStatus,displayStatus){var listenerId=null;var timeout=window.setTimeout(function(){logMessage("INFO","GPP event listener timed out");if(listenerId!=null){gppApi("removeEventListener",null,listenerId);}
fetchUserGeo();},5000);gppApi("addEventListener",function(evtData){if(listenerId==null&&evtData?.eventName=="listenerRegistered"){listenerId=evtData.listenerId;logMessage("INFO",`GPP event listener registered, id: ${listenerId}`);}
if((evtData?.eventName=="signalStatus")){signalStatus=evtData?.data;}
if((evtData?.eventName=="cmpDisplayStatus")){displayStatus=evtData?.data;}
if(signalStatus=="ready"&&displayStatus!="visible"){logMessage("INFO","GPP status ready");if(listenerId!=null){gppApi("removeEventListener",null,listenerId);}
clearTimeout(timeout);processGppData(evtData?.pingData);}});}
var checkConsentGpp=function(gppApi){logMessage("INFO","Initiating GPP ping");gppApi("ping",function(pingData){if(pingData.cmpStatus!="loaded"&&pingData.cmpStatus!="loading"){logMessage("ERROR","GPP is not enabled");fetchUserGeo();}
if(pingData?.signalStatus=="ready"){logMessage("INFO","Ping status: ready");processGppData(pingData);}else if(pingData?.signalStatus=="not ready"){logMessage("INFO","Ping status: not ready");awaitGpp(gppApi,pingData?.signalStatus,pingData?.cmpDisplayStatus);}else{logMessage("ERROR","GPP is not enabled");fetchUserGeo();}});}
setTimeout(function(){if(ccao.privacy&&ccao.privacy.ready){return}
if(!ccao.privacy.ready){logMessage("ERROR","Privacy activation timed out")
activatePrivacy();}},10000)
if(_ccScriptSettings?.user?.optOut){geoFound("optout");}else{if(window.__gpp){checkConsentGpp(window.__gpp);}else{fetchUserGeo();}}})(window,document);window.ContextualEngine=window.ContextualEngine||{};ContextualEngine.que=ContextualEngine.que||[];ContextualEngine.GetPageUrl=function(){this.PageUrl=this.PageUrl||window.location.href;return this.PageUrl;};ContextualEngine.LoadDefault=function(){this.pogoapi=this.pogoapi||"https://pogo.ccgateway.net";this.parentID=this.parentID||"unknown";if(window._ccScriptSettings&&window._ccScriptSettings.site&&this.parentID=="unknown"){this.parentID=window._ccScriptSettings.site.parentId||"unknown";}}
ContextualEngine.SetPogoAPI=function(pogoapiURL){this.pogoapi=pogoapiURL;}
ContextualEngine.SetPageUrl=function(pageUrl){this.PageUrl=pageUrl;};ContextualEngine.GeneratePogoUrl=function(){return this.pogoapi+"/v1/p/"+this.parentID+"/classification?url="+encodeURIComponent(this.GetPageUrl());}
ContextualEngine.GetClassifications=function(){this.executeEvent("On","ContextualEngineLoadClassifications");var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==200){pogoClassification=JSON.parse(this.responseText);if(pogoClassification){ContextualEngine.BrandSafetyChecked=pogoClassification.brand_safety_checked;if(pogoClassification.contextualclassifications){ContextualEngine.ContextualClassifications=pogoClassification.contextualclassifications;ContextualEngine.executeEvent("Off","ContextualEngineLoadClassifications",ContextualEngine.ContextualClassifications);}};};};xhttp.open("GET",this.GeneratePogoUrl(),true);xhttp.send();};ContextualEngine.SetGptTargetting=function(){this.executeEvent("On","ContextualEngineSetTargetting");analysis=this.GetAnalysis();BrandSafetyChecked=this.BrandSafetyChecked;window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];window.googletag.cmd.push(function(){if(analysis){if(analysis["cc-intent-id"]){googletag.pubads().setTargeting("cc-intent-id",analysis["cc-intent-id"]);}
if(analysis["cc-iab-class-id"]){googletag.pubads().setTargeting("cc-iab-class-id",analysis["cc-iab-class-id"]);}
if(analysis["cc-iab-name"]){googletag.pubads().setTargeting("cc-iab-name",analysis["cc-iab-name"]);}}
if(typeof BrandSafetyChecked!=='undefined'){googletag.pubads().setTargeting("brand_safety_checked",String(BrandSafetyChecked));}
ContextualEngine.executeEvent("Off","ContextualEngineSetTargetting");});}
ContextualEngine.SetLocalStorage=function(){this.executeEvent("On","ContextualEngineSetLocalStorage");analysis=this.GetAnalysis();if(window.localStorage&&analysis&&analysis["cc-iab-class-id"]){window.localStorage.setItem("ccContextualData",JSON.stringify(analysis["cc-iab-class-id"]))
this.executeEvent("Off","ContextualEngineSetLocalStorage");}}
ContextualEngine.Analyze=function(){this.executeEvent("On","ContextualEngineGetAnalysis");if(this.ContextualClassifications){intentIds=[];iabIds=[];iabNames=[];for(let index=0;index<this.ContextualClassifications.length;index++){classification=this.ContextualClassifications[index];if(classification.type&&classification.type=="carbon_segment_id"){if(classification.id){intentIds.push(classification.id);}}else if(classification.type&&classification.type=="iab_intent"){if(classification.id){iabIds.push(classification.id);}
if(classification.name){iabNames.push(classification.name);}}}
this.Analysis={"cc-intent-id":intentIds,"cc-iab-class-id":iabIds,"cc-iab-name":iabNames};this.analysisReady=true;this.executeEvent("Off","ContextualEngineGetAnalysis",this.Analysis);return this.Analysis}};ContextualEngine.GetAnalysis=function(){this.Analysis=this.Analysis||this.Analyze();return this.Analysis;}
ContextualEngine.setupEventListenerQueues=function(){this.eventListeners=this.eventListeners||{"OnContextualEngineInit":[],"OffContextualEngineInit":[],"OnContextualEngineReady":[],"OffContextualEngineReady":[],"OnContextualEngineLoadClassifications":[],"OffContextualEngineLoadClassifications":[],"OnContextualEngineGetAnalysis":[],"OffContextualEngineGetAnalysis":[],"OnContextualEngineSetTargetting":[],"OffContextualEngineSetTargetting":[],"OnContextualEngineSetLocalStorage":[],"OffContextualEngineSetLocalStorage":[],};}
ContextualEngine.executeEvent=function(type,eventname,data){this.setupEventListenerQueues();if(this.eventListeners[type+eventname]){for(let index=0;index<this.eventListeners[type+eventname].length;index++){try{this.eventListeners[type+eventname][index].call(this,data);}catch(e){console.log("[ERROR] issue in callback: "+e.name+": "+e.message)}}}}
ContextualEngine.isEventListenerValid=function(eventname,handler){if(eventname&&typeof(eventname)=="string"&&eventname!=""&&handler&&typeof(handler)=="function"){return true}
return false}
ContextualEngine.onEvent=function(eventname,handler){this.setupEventListenerQueues();eventOk=this.isEventListenerValid(eventname,handler);if(!eventOk){return false;}
if(this.eventListeners["On"+eventname]){this.eventListeners["On"+eventname].push(handler);return true;}
return false;}
ContextualEngine.offEvent=function(eventname,handler){this.setupEventListenerQueues();eventOk=this.isEventListenerValid(eventname,handler);if(!eventOk){return false;}
if(this.eventListeners["Off"+eventname]){this.eventListeners["Off"+eventname].push(handler);return true;}
return false;}
ContextualEngine.ProcessQue=function(){if(!this.isReady){console.log("[ERROR] ContextualEngine: "+"Status"+": "+"Not Ready Exiting Queue");return}
var tempQue=window.ContextualEngine.que||[]
for(contextCallback of tempQue){try{contextCallback();}catch(e){console.log("[ERROR] issue in callback: "+e.name+": "+e.message)}}
window.ContextualEngine.que={push:function(contextCallback){try{contextCallback();}catch(e){console.log("[ERROR] issue in callback: "+e.name+": "+e.message)}}}};ContextualEngine.Init=function(config){this.LoadDefault();this.setupEventListenerQueues();this.executeEvent("On","ContextualEngineInit");if(this.isReady){console.log("[INFO]","Already Initilized");this.executeEvent("Off","ContextualEngineInit");return;}
this.isReady=true;this.executeEvent("On","ContextualEngineReady");this.ProcessQue();this.executeEvent("Off","ContextualEngineReady");this.executeEvent("Off","ContextualEngineInit");this.offEvent("ContextualEngineLoadClassifications",this.Analyze);this.offEvent("ContextualEngineGetAnalysis",this.SetGptTargetting);this.offEvent("ContextualEngineGetAnalysis",this.SetLocalStorage);this.GetClassifications();}
ContextualEngine.isLoaded=true;ContextualEngine.Init();;(function(win,doc){var launcherSettings=win._ccLauncherSettings;var ccaoName="cca";win._ccReady=win._ccReady||[];win._ccApiReady=win._ccApiReady||[];win[ccaoName]=win[ccaoName]||function(){(win[ccaoName].q=win[ccaoName].q||[]).push(arguments);};var ccao=win[ccaoName];ccao.q=[];ccao.init=true;ccao.messageProcessor=function(){(win[ccaoName].q=win[ccaoName].q||[]).push(arguments);};ccao.push=function(){win[ccaoName].messageProcessor.apply(this,arguments);};ccao.loadedScripts={count:0};ccao.settings=win._ccScriptSettings;ccao.baseScript=ccao.baseScript||[];ccao.privacy=ccao.privacy||{que:[]};ccao.site=ccao.site||{};ccao.site.gdpr=ccao.site.gdpr||{key:"__cmp",check:true,wait:false};ccao.engagement=ccao.engagement||{ttl:60*1,count:0,id:crypto.randomUUID(),timeLastEngage:(new Date().getTime())/1000/60,}
ccao.engagement.registerEngagement=function(){var present=(new Date().getTime())/1000/60;var timediff=present-ccao.engagement.timeLastEngage;var ttlMin=ccao.engagement.ttl/60;if(timediff<ttlMin){ccao.engagement.timeLastEngage=(new Date().getTime())/1000/60;return;}
ccao.engagement.count++;ccao.engagement.id=crypto.randomUUID();ccao.engagement.timeLastEngage=(new Date().getTime())/1000/60;if(ccao.redoScriptLoad&&win._ccScriptSettings){ccao.redoScriptLoad(win._ccScriptSettings);}};ccao.clearFlagCookie=function(){if(!ccao.settings.site.sharedDomain){var img=new Image(1,1);img.src=launcherSettings.api+"/sync/clear";}};ccao.notifyCCReady=function notifyCCReady(settingObj){settingObj.pageData={"pvid":crypto.randomUUID()};ccao.settings=settingObj;win._ccSettings=settingObj;if(win._ccReady!==null){var readyLen=win._ccReady.length;for(var i=0;i<readyLen;i++){win._ccReady[i](settingObj);}}
win._ccReady={"push":function(pushFunc){if(typeof(pushFunc)==='function')pushFunc(settingObj);}};};ccao.notifyApiReady=function notifyApiReady(){if(win._ccApiReady!==null){var readyLen=win._ccApiReady.length;for(var i=0;i<readyLen;i++){win._ccApiReady[i]();}}
win._ccApiReady={"push":function(pushFunc){if(typeof(pushFunc)==='function')pushFunc();}};};ccao.getSettings=function getSettings(readyCallback){win._ccReady.push(readyCallback);};ccao.afterPageLoad=function(func){if(document.readyState==="complete"){func();}else{ccao.attachCCEvent("load",function(){func();});}};ccao.attachCCEvent=function(eventName,eventCallback){try{win.addEventListener?win.addEventListener(eventName,eventCallback,true):win.attachEvent&&win.attachEvent("on"+eventName,eventCallback);}catch(e){console&&console.log(e);}};function newCustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
function setStorage(store,key,value){if(!ccao.privacy.law||typeof ccao.privacy.law!=="string"){ccao.privacy.law="unknown";}
switch(ccao.privacy.law.toLowerCase()){case "gdpr":if(ccao.privacy.gdpr.Consent){store.setItem(key,value);}
break;case "ccpa":if(ccao.privacy.ccpa.Consent){store.setItem(key,value);}
break;case "na":store.setItem(key,value);break;case "optout":case "unknown":default:break;}}
var createCustomEvent=function(evtType,evtDetail){if(typeof win.CustomEvent==="function")return new CustomEvent(evtType,{detail:evtDetail});return newCustomEvent(evtType,{detail:evtDetail});};function api(){var userId=null;this.ready=false;this.addEventListener=function(evt,listenerCallback){if(this.eventTarget){this.eventTarget.addEventListener(evt,listenerCallback);}};this.readyEvent=function(eventCallback){if(this.eventTarget){this.eventTarget.addEventListener('apiReady',function(evt){eventCallback({'userId':userId});});}};this.realtimeReady=function(realtimeCallback){if(this.eventTarget){this.eventTarget.addEventListener('realtimeReady',function(evt){realtimeCallback(evt.detail);});}};if(this.eventTarget){this.eventTarget.addEventListener('userIdReady',function(evt){userId=evt.detail.id;});}
this.userIdEvent=function(idEventCallback){if(this.eventTarget){this.eventTarget.addEventListener('userIdReady',function(evt){idEventCallback(evt.detail.id,evt.detail.isNew);});}
if(userId!==null&&this.ready===false){idEventCallback(userId,window._ccScriptSettings.user.isNew);}};if(this.eventTarget){this.eventTarget.addEventListener('audiencesReady',function(evt){ccao.settings.user.audienceMemberships=evt.detail;var user={audienceMemberships:evt.detail};ccao.privacy=ccao.privacy||{};ccao.privacy.que=ccao.privacy.que||[];ccao.privacy.que.push(function(){setStorage(win.sessionStorage,"carbonUser",JSON.stringify(user));});});}
this.audiencesReady=function(audReadyCallback){if(this.eventTarget){this.eventTarget.addEventListener('audiencesReady',function(evt){audReadyCallback(evt.detail);});}};if(this.eventTarget){this.eventTarget.addEventListener('interestsReady',function(evt){ccao.settings.user.interests=evt.detail;});}
this.interestsReady=function(interestReadyCallback){if(this.eventTarget){this.eventTarget.addEventListener('interestsReady',function(evt){interestReadyCallback(evt.detail);});}};if(this.eventTarget){this.eventTarget.addEventListener('demographicsReady',function(evt){ccao.settings.user.demographics=evt.detail;});}
this.demographicsReady=function(demoReadyCallback){if(this.eventTarget){this.eventTarget.addEventListener('demographicsReady',function(evt){demoReadyCallback(evt.detail);});}};this.brandsReady=function(brandReadyCallback){if(this.eventTarget){this.eventTarget.addEventListener('brandsReady',function(evt){brandReadyCallback(evt.detail);});}};if(this.eventTarget){this.eventTarget.addEventListener('brandsReady',function(evt){ccao.settings.user.brands=evt.detail;});}};api.prototype.eventTarget=document.createElement(null);api.prototype.dispatchEvent=function(evtType,detail){this.eventTarget.dispatchEvent(createCustomEvent(evtType,detail));};ccao.api=new api();win.carbonApi=ccao.api;win.carbon=win.carbonApi;ccao.notifyApiReady();function userIdComplete(){try{if(win._ccScriptSettings.localCacheUserTracking&&ccao.setUserStorage){ccao.setUserStorage();}
ccao.api.dispatchEvent('userIdReady',{id:window._ccScriptSettings.user.id,isNew:window._ccScriptSettings.user.isNew});}catch(err){console.debug('error:'+err.message);}}
ccao.loadScript=function(scriptUri,scriptLoadCallback,onError){setTimeout(function(){var scriptTag=document.createElement("script");scriptTag.src=scriptUri;scriptTag.type="text/javascript";scriptTag.async=true;if(scriptLoadCallback!==undefined){scriptTag.addEventListener('load',scriptLoadCallback);}
if(onError!==undefined){scriptTag.onerror=onError;}
document.body.appendChild(scriptTag);},1);};var loadBundle=function(){ccao.loadScript(launcherSettings.api+"/script/bundle?id="+launcherSettings.script+"&parentId="+launcherSettings.parent);};var decideUserId=function(continueCallback){ccao.mergeUserIds=function(){ccao.mergeUserIds=null;var baseUser={ccuid:null,ccsid:null};var localUser=win._ccScriptSettings.user.localCachedUser||{localCache:false,cached:false};var bcUser=win._ccScriptSettings.user.browserCachedUser||{browserCache:false,cached:false};var fpFrameUser=win._ccScriptSettings.user.fpframeuser||{fp:false};var cachedUser=Object.assign({},baseUser,localUser,bcUser,fpFrameUser);if(cachedUser.fp===true||cachedUser.cached===true){win._ccScriptSettings.user.isNew=false;if(win._ccScriptSettings.user.id!==cachedUser.ccuid){win._ccScriptSettings.user.id=cachedUser.ccuid;win._ccScriptSettings.user.idChange=true;}}else if(cachedUser.ccuid!==null&&win._ccScriptSettings.user.isNew===true){win._ccScriptSettings.user.id=cachedUser.ccuid;}
if(cachedUser.ccsid!==null){win._ccScriptSettings.session.isNew=false;if(win._ccScriptSettings.session.id!==cachedUser.ccsid){win._ccScriptSettings.session.id=cachedUser.ccsid;win._ccScriptSettings.user.idChange=true;}}
userIdComplete();continueCallback();};if(win._ccScriptSettings.cookieSettingsType===4&&typeof(win._ccScriptSettings.user.fpframeuser)==='undefined'){ccao.mergeUserIdTimeout=window.setTimeout(ccao.mergeUserIds,1500);}else{ccao.mergeUserIds();}};var setUser=function(endpoint){if(!ccao.privacy.law||typeof ccao.privacy.law!=="string"){ccao.privacy.law="unknown";}
switch(ccao.privacy.law.toLowerCase()){case "gdpr":if(ccao.privacy.gdpr.Consent){ccao.loadScript(endpoint);}
break;case "ccpa":if(ccao.privacy.ccpa.Consent){ccao.loadScript(endpoint);}
break;case "na":var img=new Image(1,1);ccao.loadScript(endpoint);break;case "optout":case "unknown":default:break;}}
var loaded=false;var scriptsLoadedCallback=function(){if(loaded===true)
return;loaded=true;var finishLaunch=function(){if(win._ccScriptSettings.cookieSettingsType===0||win._ccScriptSettings.cookieSettingsType===3){if(win._ccScriptSettings.user.idChange!==undefined||win._ccScriptSettings.user.isNew||win._ccScriptSettings.session.isNew){var endpoint=win._ccLauncherSettings.api+'/setUser?parent='+win._ccScriptSettings.site.parentId+'&site='+win._ccScriptSettings.site.scriptId+'&ccuid='+win._ccScriptSettings.user.id+'&ccsid='+win._ccScriptSettings.session.id;ccao.privacy=ccao.privacy||{};ccao.privacy.que=ccao.privacy.que||[];ccao.privacy.que.push(function(){setUser(endpoint);if(!win._ccLauncherSettings.api.includes(".ccgateway.net")){endpoint=endpoint.replace(win._ccLauncherSettings.api,win._ccLauncherSettings.cdn);setUser(endpoint);}});}}
if(win._ccScriptSettings.cookieSettingsType===4){if(win._ccScriptSettings.user.idChange!==undefined||win._ccScriptSettings.user.isNew||win._ccScriptSettings.session.isNew){ccao.setFpFrameUser(win._ccScriptSettings.user.id,win._ccScriptSettings.session.id);}}
var samplingSettings=win._ccScriptSettings.sampling||{active:false,sample:true};if(samplingSettings.active===false||samplingSettings.sample===true)
loadBundle();else
ccao.samplingCallback=loadBundle;userIdComplete();};var fpRedirectCallback=function(){ccao.fpRedirect(finishLaunch);};var callbackFunc=win._ccScriptSettings.cookieSettingsType===1&&ccao.fpRedirect?fpRedirectCallback:finishLaunch;decideUserId(callbackFunc);};var loadedScripts=0;var launchScriptCallback=function(){if(++loadedScripts===win._ccScriptSettings.launcherScripts.length){window.setTimeout(function(){scriptsLoadedCallback();},1);}};ccao.launchScripts=function(){if(win._ccScriptSettings.launcherScripts){for(var scriptIndex=0;scriptIndex<win._ccScriptSettings.launcherScripts.length;scriptIndex++){ccao.loadScript(win._ccScriptSettings.launcherScripts[scriptIndex],launchScriptCallback);}}};var launch=function(){var doLaunch=function(ccuid,iscached){var browserCachedUser={cached:false,browserCache:false};if(iscached){browserCachedUser.browserCache=browserCachedUser.cached=true;}
browserCachedUser.ccuid=ccuid;win._ccScriptSettings.user.browserCachedUser=browserCachedUser;if(loadedScripts===win._ccScriptSettings.launcherScripts.length){scriptsLoadedCallback();}};if(win._ccScriptSettings.browserCacheUserTracking){var requestTime=new Date();ccao.idCallback=function(){var cached=false;if(win.carbonUIDCache===undefined)
cached=true;else
cached=win.carbonUIDCache<requestTime;doLaunch(win._carbonUID,cached);ccao.idCallback=undefined;};}
ccao.launchScripts();};ccao.privacy=ccao.privacy||{};ccao.privacy.que=ccao.privacy.que||[];ccao.privacy.que.push(function(){switch(ccao.privacy.law.toLowerCase()){case "gdpr":if(ccao.privacy.gdpr.Consent){launch();}
break;case "ccpa":if(ccao.privacy.ccpa.Consent){launch();}
break;case "na":launch();break;case "optout":case "unknown":default:break;}});})(window,document);